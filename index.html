<HTML >
   <HEAD>
       <title>Skills pointer</title>
       <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
   </HEAD> 
   <body>
       <p>Qui pourrait m'aider sur...</p>
       <form action="" onSubmit="searchSkills(); return false;">
            <input id="skillInput" type="text" placeholder="ex : angular">
            <button>OK</button>
        </form>

       <div id="result">
           <ul id="result_list">
               
           </ul>        
       </div>
       <div id="nobody" style="display: none;">
           <p>Aucune personne ne peut vous aider</p>
       </div>

       <script>
          $('#skillInput').change(searchSkills);
            var dbname = 'skillspointer';

           function searchSkills() {
              var persons = JSON.parse(localStorage[dbname]).persons;
              var recommendations = JSON.parse(localStorage[dbname]).recommendations;
              
               $("#result_list").empty();
               $("#nobody").attr("style").value= "display: none;";
                var searchedSkill = document.getElementById("skillInput").value;

                var findRecommendation = recommendations.filter(r => r.skill === searchedSkill);

                if (findRecommendation.length > 0)
                {
                    var peopleWithSkill = persons.filter( p => findRecommendation.find( r => r.recommendee === p.id)) ;

                    peopleWithSkill.forEach(p => {
                        $("#result_list").append($("<li>" + p.name + " (" + p.location + ")</li>"));
                        
                    });  
                }         
                else{
                    $("#nobody").removeAttr("style");
                }      
           }
       </script>

   </body>
</HTML>